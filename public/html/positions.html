  <!DOCTYPE html>
  <html lang="zh-CN">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Position Management - Financial Management System</title>
      <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="./i18n.js"></script>
      <script src="./realtime-data-manager.js"></script>
      <style>
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        }

        :root {
          --primary: #2563eb;
          --primary-light: #3b82f6;
          --success: #10b981;
          --danger: #ef4444;
          --warning: #f59e0b;
          --dark: #1e293b;
          --darker: #0f172a;
          --light: #f8fafc;
          --gray: #94a3b8;
          --border: #e2e8f0;
          --card-bg: #ffffff;
          --header-bg: #ffffff;
          --body-bg: #f1f5f9;
          --chart-gradient: linear-gradient(
            90deg,
            rgba(37, 99, 235, 0.1),
            rgba(59, 130, 246, 0.05)
          );
        }

        body {
          background-color: var(--body-bg);
          color: var(--dark);
          line-height: 1.6;
        }

        .container {
          max-width: 1400px;
          margin: 0 auto;
          padding: 20px;
        }

        header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 30px;
          padding-bottom: 15px;
          border-bottom: 1px solid var(--border);
          background-color: var(--header-bg);
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .logo {
          display: flex;
          align-items: center;
          gap: 12px;
        }

        .logo i {
          color: var(--primary);
          font-size: 28px;
        }

        .logo h1 {
          font-size: 24px;
          font-weight: 700;
          color: var(--darker);
        }

        .nav-tabs {
          display: flex;
          gap: 15px;
          list-style: none;
        }

        .nav-tabs li a {
          color: var(--gray);
          text-decoration: none;
          font-weight: 500;
          padding: 8px 16px;
          border-radius: 20px;
          transition: all 0.3s ease;
          font-size: 15px;
        }

        .nav-tabs li a.active,
        .nav-tabs li a:hover {
          background-color: rgba(37, 99, 235, 0.08);
          color: var(--primary);
        }

        .panel {
          background-color: var(--card-bg);
          border-radius: 16px;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
          padding: 25px;
          margin-bottom: 25px;
        }

        .panel-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 25px;
        }

        .panel-title {
          font-size: 20px;
          font-weight: 600;
          color: var(--darker);
        }

        .panel-actions {
          display: flex;
          gap: 10px;
        }

        .btn {
          padding: 8px 16px;
          border-radius: 8px;
          border: none;
          cursor: pointer;
          font-weight: 500;
          font-size: 14px;
          transition: all 0.3s ease;
          display: flex;
          align-items: center;
          gap: 6px;
        }

        .btn-primary {
          background-color: var(--primary);
          color: white;
        }

        .btn-primary:hover {
          background-color: var(--primary-light);
        }

        .btn-outline {
          background-color: transparent;
          border: 1px solid var(--border);
          color: var(--dark);
        }

        .btn-outline:hover {
          background-color: var(--light);
        }

        .summary-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
        }

        .summary-card {
          background: var(--card-bg);
          border-radius: 12px;
          padding: 20px;
          border: 1px solid var(--border);
          transition: all 0.3s ease;
        }

        .summary-card:hover {
          box-shadow: 0 6px 12px rgba(0, 0, 0, 0.07);
          transform: translateY(-3px);
        }

        .summary-card-title {
          font-size: 15px;
          color: var(--gray);
          margin-bottom: 10px;
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .summary-card-value {
          font-size: 26px;
          font-weight: 700;
          margin-bottom: 6px;
        }

        .summary-card-info {
          font-size: 14px;
          color: var(--gray);
          display: flex;
          align-items: center;
          gap: 6px;
        }

        .positive {
          color: var(--success);
        }

        .negative {
          color: var(--danger);
        }

        .chart-container {
          height: 350px;
          margin: 25px 0;
          background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
          border-radius: 16px;
          padding: 20px;
          box-shadow: 
            0 4px 20px rgba(0, 0, 0, 0.08),
            inset 0 1px 0 rgba(255, 255, 255, 0.6);
          border: 1px solid rgba(255, 255, 255, 0.2);
          position: relative;
          overflow: hidden;
        }

        .chart-container::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: radial-gradient(circle at 30% 30%, rgba(59, 130, 246, 0.05) 0%, transparent 50%);
          pointer-events: none;
        }

        .chart-container canvas {
          position: relative;
          z-index: 1;
        }

        .data-section {
          background-color: var(--card-bg);
          border-radius: 12px;
          padding: 25px;
          margin-top: 25px;
        }

        .data-section-title {
          font-size: 18px;
          font-weight: 600;
          color: var(--darker);
          margin-bottom: 20px;
          padding-bottom: 15px;
          border-bottom: 1px solid var(--border);
        }

        .cash-flow {
          display: flex;
          gap: 20px;
          margin-top: 25px;
        }

        .flow-card {
          flex: 1;
          background-color: var(--card-bg);
          border-radius: 12px;
          padding: 25px;
          text-align: center;
          border: 1px solid var(--border);
        }

        .flow-card.income {
          border-top: 4px solid var(--success);
        }

        .flow-card.spending {
          border-top: 4px solid var(--danger);
        }

        .flow-title {
          font-size: 17px;
          font-weight: 600;
          margin-bottom: 15px;
          color: var(--darker);
        }

        .flow-value {
          font-size: 28px;
          font-weight: 700;
          margin-bottom: 10px;
        }

        .flow-info {
          font-size: 14px;
          color: var(--gray);
        }

        .status-badge {
          padding: 4px 10px;
          border-radius: 20px;
          font-size: 12px;
          font-weight: 500;
        }

        .status-badge.positive {
          background-color: rgba(16, 185, 129, 0.1);
          color: var(--success);
        }

        .status-badge.negative {
          background-color: rgba(239, 68, 68, 0.1);
          color: var(--danger);
        }

        /* ÊåÅ‰ªìÂàÜÂ∏ÉÂõæË°®ÁâπÊÆäÊ†∑Âºè */
        .distribution-chart {
          background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
          border-radius: 20px;
          padding: 30px;
          box-shadow: 
            0 10px 40px rgba(0, 0, 0, 0.1),
            0 4px 15px rgba(0, 0, 0, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.8);
          position: relative;
          overflow: hidden;
        }

        .distribution-chart::before {
          content: '';
          position: absolute;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: radial-gradient(circle, rgba(37, 99, 235, 0.03) 0%, transparent 70%);
          animation: rotateGradient 20s linear infinite;
          pointer-events: none;
        }

        @keyframes rotateGradient {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }

        .distribution-chart .data-section-title {
          position: relative;
          z-index: 2;
          background: linear-gradient(90deg, var(--primary), var(--primary-light));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          font-size: 20px;
          font-weight: 700;
          margin-bottom: 25px;
          padding-bottom: 20px;
          border-bottom: 2px solid rgba(37, 99, 235, 0.1);
          display: flex;
          align-items: center;
          gap: 10px;
        }

        .distribution-chart .data-section-title::before {
          content: 'üìä';
          font-size: 24px;
          filter: drop-shadow(0 2px 4px rgba(37, 99, 235, 0.3));
        }

        /* ÊåÅ‰ªìÁÆ°ÁêÜÈ°µÈù¢ÁâπÊúâÊ†∑Âºè */
        .positions-container {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 25px;
        }

        .positions-table-container {
          grid-column: span 2;
        }

        .positions-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 20px;
        }

        .positions-table th {
          background-color: var(--primary);
          color: white;
          text-align: left;
          padding: 15px;
          font-weight: 500;
        }

        .positions-table td {
          padding: 15px;
          border-bottom: 1px solid var(--border);
        }

        .positions-table tr:nth-child(even) {
          background-color: var(--light);
        }

        .positions-table tr:hover {
          background-color: rgba(59, 130, 246, 0.05);
        }

        .position-actions {
          display: flex;
          gap: 8px;
        }

        .action-btn {
          padding: 6px 12px;
          border-radius: 4px;
          border: none;
          cursor: pointer;
          font-size: 12px;
          font-weight: 500;
        }

        .action-btn.edit {
          background-color: rgba(245, 158, 11, 0.1);
          color: var(--warning);
        }

        .action-btn.delete {
          background-color: rgba(239, 68, 68, 0.1);
          color: var(--danger);
        }

        .position-details {
          display: flex;
          align-items: center;
        }

        .position-icon {
          width: 36px;
          height: 36px;
          border-radius: 6px;
          background-color: rgba(37, 99, 235, 0.1);
          display: flex;
          align-items: center;
          justify-content: center;
          margin-right: 12px;
          color: var(--primary);
        }

        .position-name {
          font-weight: 600;
        }

        .position-ticker {
          font-size: 14px;
          color: var(--gray);
        }

        .position-change {
          font-weight: 600;
        }

        .position-change.positive {
          color: var(--success);
        }

        .position-change.negative {
          color: var(--danger);
        }

        .position-percentage {
          font-weight: 600;
          color: var(--dark);
        }

        .gainers-losers {
          grid-column: span 1;
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
        }

        /* Stock Logo Styles */
        .stock-logo {
          width: 24px;
          height: 24px;
          border-radius: 4px;
          object-fit: cover;
          margin-right: 8px;
          border: 1px solid #e2e8f0;
          background: white;
        }

        .position-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 10px 12px;
          margin-bottom: 8px;
          background: white;
          border-radius: 8px;
          border: 1px solid #e2e8f0;
          transition: all 0.2s ease;
        }

        .position-item:hover {
          transform: translateY(-1px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          border-color: var(--primary);
        }

        .position-info {
          display: flex;
          align-items: center;
          flex: 1;
        }

        .position-item-name {
          font-weight: 600;
          color: var(--darker);
          font-size: 14px;
        }

        .position-item-change {
          font-weight: 700;
          font-size: 14px;
          padding: 4px 8px;
          border-radius: 4px;
        }

        .position-item-change.positive {
          color: #059669;
          background: rgba(5, 150, 105, 0.1);
        }

        .position-item-change.negative {
          color: #dc2626;
          background: rgba(220, 38, 38, 0.1);
        }

        .gainers-container,
        .losers-container {
          background-color: var(--card-bg);
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .section-title {
          font-size: 16px;
          font-weight: 600;
          margin-bottom: 15px;
          color: var(--darker);
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .gainers-list,
        .losers-list {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }

        .filter-bar {
          display: flex;
          gap: 15px;
          margin-bottom: 20px;
          padding: 15px;
          background-color: var(--card-bg);
          border-radius: 12px;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .filter-group {
          display: flex;
          flex-direction: column;
          gap: 6px;
        }

        .filter-group label {
          font-size: 14px;
          color: var(--gray);
        }

        .filter-group select,
        .filter-group input {
          padding: 8px 12px;
          border: 1px solid var(--border);
          border-radius: 6px;
          background-color: white;
        }

        /* Language Toggle Button Styles */
        .lang-toggle {
          position: relative;
          background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
          color: white;
          border: none;
          border-radius: 25px;
          padding: 8px 20px;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
          overflow: hidden;
          min-width: 80px;
          margin-left: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 6px;
        }

        .lang-toggle::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
          transition: left 0.5s;
        }

        .lang-toggle:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(37, 99, 235, 0.4);
          background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
        }

        .lang-toggle:hover::before {
          left: 100%;
        }

        .lang-toggle:active {
          transform: translateY(0);
          box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }

        .lang-toggle .flag-icon {
          font-size: 16px;
          transition: transform 0.3s ease;
        }

        .lang-toggle:hover .flag-icon {
          transform: scale(1.1);
        }

        .lang-toggle.switching {
          animation: langSwitchPulse 0.6s ease-in-out;
        }

        @keyframes langSwitchPulse {
          0%, 100% {
            transform: scale(1);
          }
          50% {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(37, 99, 235, 0.5);
          }
        }

        @media (max-width: 1200px) {
          .dashboard-layout {
            grid-template-columns: 1fr;
          }

          .positions-container {
            grid-template-columns: 1fr;
          }

          .positions-table-container {
            grid-column: span 1;
          }
        }

        @media (max-width: 768px) {
          header {
            flex-direction: column;
            gap: 15px;
            padding: 15px;
          }

          .nav-tabs {
            flex-wrap: wrap;
            justify-content: center;
          }

          .summary-cards {
            grid-template-columns: 1fr;
          }

          .cash-flow {
            flex-direction: column;
          }

          .gainers-losers {
            grid-template-columns: 1fr;
          }

          .filter-bar {
            flex-direction: column;
          }

          .lang-toggle {
            margin-left: 0;
            margin-top: 10px;
          }
        }
      </style>
    </head>
    <body>
      <div class="container">
        <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
        <header>
          <div class="logo">
            <i class="fas fa-chart-line"></i>
            <h1 data-i18n="system_title">Financial Asset Management System</h1>
          </div>
          <div style="display: flex; align-items: center; gap: 20px">
            <ul class="nav-tabs">
              <li>
                <a href="#" class="active" data-i18n="nav_asset">
                  Asset Management
                </a>
              </li>
              <li>
                <a href="./trades.html" data-i18n="nav_trade">Trade Management</a>
              </li>
              <li>
                <a href="./stocks.html" data-i18n="nav_stock">Stock Trading</a>
              </li>
            </ul>
            <button id="lang-toggle" class="lang-toggle">
              <span class="flag-icon">üá®üá≥</span>
              <span>‰∏≠Êñá</span>
            </button>
          </div>
        </header>

        <!-- ÊåÅ‰ªìÁÆ°ÁêÜÂÜÖÂÆπ -->
        <div class="panel">
          <div class="panel-header">
            <h2 class="panel-title" data-i18n="assets_management">
              Assets Management
            </h2>
          </div>

          <!-- ÊåÅ‰ªìÊ¶ÇËßàÂç°Áâá -->
          <!-- ËµÑ‰∫ßÊ¶ÇËßàÂç°Áâá -->
          <div class="summary-cards">
            <div class="summary-card">
              <div class="summary-card-title">
                <i class="fas fa-wallet"></i>
                <span data-i18n="total_assets">Total Assets</span>
              </div>
              <div class="summary-card-value" id="total-assets">
                $2,317,371.20
              </div>
            </div>

            <div class="summary-card">
              <div class="summary-card-title">
                <i class="fas fa-chart-line"></i>
                <span data-i18n="total_profit_loss">Total Profit/Loss</span>
              </div>
              <div class="summary-card-value positive" id="total-profit-loss">
                $63,253.45
              </div>
            </div>

            <div class="summary-card">
              <div class="summary-card-title">
                <i class="fas fa-sync"></i>
                <span data-i18n="daily_profit_loss">Daily Profit/Loss</span>
              </div>
              <div class="summary-card-value negative" id="daily-profit-loss">
                -$3,210.15
              </div>
            </div>

            <div class="summary-card">
              <div class="summary-card-title">
                <i class="fas fa-coins"></i>
                <span data-i18n="total_market_value">Total Market Value</span>
              </div>
              <div class="summary-card-value" id="total-market-value">
                $1,963,253.45
              </div>
            </div>
          </div>

          <!-- Áé∞ÈáëÊµÅ -->
          <div class="data-section">
            <div class="cash-flow" style="display: flex; gap: 20px;">
              <div class="flow-card available-assets-card" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; border-top: 4px solid var(--primary);">
                <i class="fas fa-piggy-bank" style="font-size: 32px; color: var(--primary); margin-bottom: 10px;"></i>
                <div class="flow-title" data-i18n="available_assets" style="margin-bottom: 8px;">Available Assets</div>
                <div id="available-assets-value" class="flow-value" style="color: var(--primary);">$0.00</div>
              </div>
              <div class="flow-card spending" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; border-top: 4px solid var(--danger);">
                <i class="fas fa-money-bill-wave" style="color: var(--danger); font-size: 32px; margin-bottom: 10px;"></i>
                <div class="flow-title" data-i18n="spending" style="margin-bottom: 8px;">Spending</div>
                <div class="flow-value negative" id="cash-flow-outcome">$42,500</div>
              </div>
            </div>
            </div>
          </div>

          <!-- ÊåÅ‰ªìÂÜÖÂÆπÂå∫Âüü -->
          <div class="positions-container">
            <!-- ÊåÅ‰ªìÂàÜÂ∏ÉÂõæË°® -->
            <div class="distribution-chart">
              <div class="data-section">
                <div class="data-section-title" data-i18n="position_distribution">
                  Position Distribution
                </div>
                <div class="chart-container">
                  <canvas id="positionDistributionChart"></canvas>
                </div>
              </div>
            </div>

            <!-- Ê∂®Ë∑åËÇ°ÂàóË°® -->
            <div class="gainers-losers">
              <div class="gainers-container">
                <div class="section-title">
                  <i class="fas fa-arrow-up positive"></i>
                  <span data-i18n="top_gainers">Top Gainers</span>
                </div>
                <div class="gainers-list" id="gainers-list">
                  <!-- Generated by JS -->
                </div>
              </div>

              <div class="losers-container">
                <div class="section-title">
                  <i class="fas fa-arrow-down negative"></i>
                  <span data-i18n="top_losers">Top Losers</span>
                </div>
                <div class="losers-list" id="losers-list">
                  <!-- Generated by JS -->
                </div>
              </div>
            </div>

            <!-- ÊåÅ‰ªìË°®Ê†º -->
            <div class="positions-table-container">
              <div class="data-section">
                <div class="data-section-title" data-i18n="position_details">
                  Position Details
                </div>
                <table class="positions-table">
                  <thead>
                    <tr>
                      <th data-i18n="stock">Stock</th>
                      <th data-i18n="cost_price">Cost Price</th>
                      <th data-i18n="current_price">Current Price</th>
                      <th data-i18n="quantity">Quantity</th>
                      <th data-i18n="daily_profit_loss">Daily Profit/Loss</th>
                      <th data-i18n="position_ratio">Position Ratio</th>
                      <th data-i18n="position_value">Position Value</th>
                    </tr>
                  </thead>
                  <tbody id="positions-table-body">
                    <!-- Generated by JS -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script>
        // localStorageÈîÆÂêç
        const AVAILABLE_ASSETS_KEY = 'available_assets'
        // Ë¥¶Êà∑ÂàùÂßãÂèØÁî®ËµÑÈáë - ‰∏éstocks.html‰øùÊåÅ‰∏ÄËá¥
        const INITIAL_CASH = 1000000
        // ËµÑ‰∫ßÊï∞ÊçÆÂØπË±°ÔºåÂêéÁª≠‰ºöÊ†πÊçÆpositionsDataÂä®ÊÄÅÊõ¥Êñ∞
        let assetsData = {
          total_assets: INITIAL_CASH, // ÊÄªËµÑ‰∫ß = Ââ©‰ΩôÁé∞Èáë + ÊåÅ‰ªìÂ∏ÇÂÄº
          total_profit_loss: 0,      // ÊÄªÁõà‰∫è
          daily_profit_loss: 0,      // Êó•Áõà‰∫è
          total_market_value: 0,     // ÊÄªÂ∏ÇÂÄº
          cash_flow: {
            available_assets:0, // ÂΩìÂâçÂèØÁî®ËµÑ‰∫ß
            income: 0,               // Êî∂ÂÖ•ÔºàÂçñÂá∫ËÇ°Á•®Ëé∑ÂæóÁöÑÁé∞ÈáëÔºåÊöÇËÆæ‰∏∫0Ôºâ
            outcome: 0,              // ÊîØÂá∫Ôºà‰π∞ÂÖ•ËÇ°Á•®Ëä±Ë¥πÁöÑÊàêÊú¨Ôºâ
          },
        }

        // ‰ªéÂêéÁ´ØËé∑ÂèñËµÑ‰∫ßÊ±áÊÄªÊï∞ÊçÆ
        async function fetchAssetsSummary() {
          try {
            const response = await fetch('http://localhost:3002/stocks/summary')
            const data = await response.json()
            
            // Êõ¥Êñ∞assetsData
            assetsData = {
              total_assets: Number(data.totalAssets) || 0,
              total_profit_loss: Number(data.totalProfit) || 0,
              daily_profit_loss: Number(data.totalDailyProfit) || 0,
              total_market_value: Number(data.totalMarketValue) || 0,
              cash_flow: {
                available_assets: Number(data.cashflow) || 0,
                income: 0,
                outcome: 0,
              },
            }
            
            // ÂêåÊ≠•Êõ¥Êñ∞localStorageÔºå‰øùÊåÅ‰∏éstocks.html‰∏ÄËá¥
            localStorage.setItem(AVAILABLE_ASSETS_KEY, data.cashflow.toString())
            
            return data
          } catch (error) {
            console.error('Ëé∑ÂèñËµÑ‰∫ßÊ±áÊÄªÊï∞ÊçÆÂ§±Ë¥•', error)
            return null
          }
        }

        // Ê†πÊçÆpositionsDataÂä®ÊÄÅÊõ¥Êñ∞assetsData
        function updateAssetsDataFromPositions() {
          // ÊÄªÂ∏ÇÂÄº = ‚àë(ÂΩìÂâç‰ª∑ * Êï∞Èáè)
          const totalMarketValue = positionsData.reduce((sum, p) => sum + p.stock_current_price * p.quantity, 0)
          // ÊÄªÁõà‰∫è = ‚àë((ÂΩìÂâç‰ª∑-ÊàêÊú¨‰ª∑)*Êï∞Èáè)
          const totalProfitLoss = positionsData.reduce((sum, p) => sum + (p.stock_current_price - p.stock_cost) * p.quantity, 0)
          // Êó•Áõà‰∫è = ‚àë(daily_profit_loss)
          const dailyProfitLoss = positionsData.reduce((sum, p) => sum + p.daily_profit_loss, 0)
          // ÊÄªÊàêÊú¨ = ‚àë(ÊàêÊú¨‰ª∑ * Êï∞Èáè)
          const totalCost = positionsData.reduce((sum, p) => sum + p.stock_cost * p.quantity, 0)
          // Ââ©‰ΩôÂèØÁî®ËµÑÈáë = ÂàùÂßãËµÑÈáë - ÊÄªÊàêÊú¨
          const availableCash = INITIAL_CASH - totalCost
          // ÊÄªËµÑ‰∫ß = Ââ©‰ΩôÂèØÁî®ËµÑÈáë + ÊÄªÂ∏ÇÂÄº
          const totalAssets = availableCash + totalMarketValue
          // ÊîØÂá∫ = ‰π∞ÂÖ•ËÇ°Á•®Ëä±Ë¥πÁöÑÊàêÊú¨
          const outcome = totalCost
          // Êî∂ÂÖ• = ÂçñÂá∫ËÇ°Á•®Ëé∑ÂæóÁöÑÁé∞ÈáëÔºàÂ¶ÇÊúâÂçñÂá∫ËÆ∞ÂΩïÂèØË°•ÂÖÖÔºåËøôÈáå‰∏∫0Ôºâ
          const income = 0

          assetsData = {
            total_assets: totalAssets,
            total_profit_loss: totalProfitLoss,
            daily_profit_loss: dailyProfitLoss,
            total_market_value: totalMarketValue,
            cash_flow: {
              available_assets:availableCash,
              income: income,
              outcome: totalCost, // ‰ΩøÁî®ËÆ°ÁÆóÂá∫ÁöÑÊÄªÊàêÊú¨‰Ωú‰∏∫ÊîØÂá∫
            },
          }
        }

        // Ê∏≤ÊüìÂΩìÂâçÂèØÁî®ËµÑ‰∫ß
        function renderAvailableAssets() {
          // ÊòæÁ§∫ÂΩìÂâçassetsData‰∏≠ÁöÑavailable_assetsÂÄº
          const value = assetsData.cash_flow.available_assets
          document.getElementById('available-assets-value').textContent = formatCurrency(value)
          console.log('Current available assets:', value)
        }

        // Êõ¥Êñ∞ÊîØÂá∫ÊòæÁ§∫
        function updateSpendingDisplay() {
          // ËÆ°ÁÆóÊîØÂá∫ÔºàÊàêÊú¨‰ª∑‰πò‰ª•Êï∞ÈáèÔºâ
          const totalSpending = positionsData.reduce((sum, p) => sum + p.stock_cost * p.quantity, 0)
          assetsData.cash_flow.outcome = totalSpending
          document.getElementById('cash-flow-outcome').textContent = formatCurrency(totalSpending)
          console.log('Current spending:', totalSpending)
        }

        // ÊåÅ‰ªìÊï∞ÊçÆ - ÂàùÂßã‰∏∫Á©∫ÔºåÂêéÁª≠ÈÄöËøáÊé•Âè£Ëé∑Âèñ
        let positionsData = []
        
        // ÂõæË°®ÂÆû‰æãÔºåÁî®‰∫éÈîÄÊØÅÂíåÈáçÊñ∞ÂàõÂª∫
        let positionChart = null

        // Stock data mapping for logos and names (‰∏éstocks.html‰øùÊåÅ‰∏ÄËá¥)
        const stockData = {
          'AAPL': {
            name: 'Apple Inc.',
            logo: 'https://logo.clearbit.com/apple.com',
            ticker: 'AAPL'
          },
          'AMD': {
            name: 'Advanced Micro Devices',
            logo: 'https://logo.clearbit.com/amd.com',
            ticker: 'AMD'
          },
          'AMZN': {
            name: 'Amazon.com Inc.',
            logo: 'https://logo.clearbit.com/amazon.com',
            ticker: 'AMZN'
          },
          'GOOG': {
            name: 'Alphabet Inc.',
            logo: 'https://logo.clearbit.com/google.com',
            ticker: 'GOOG'
          },
          'INTC': {
            name: 'Intel Corporation',
            logo: 'https://logo.clearbit.com/intel.com',
            ticker: 'INTC'
          },
          'META': {
            name: 'Meta Platforms Inc.',
            logo: 'https://logo.clearbit.com/meta.com',
            ticker: 'META'
          },
          'MSFT': {
            name: 'Microsoft Corporation',
            logo: 'https://logo.clearbit.com/microsoft.com',
            ticker: 'MSFT'
          },
          'NFLX': {
            name: 'Netflix Inc.',
            logo: 'https://logo.clearbit.com/netflix.com',
            ticker: 'NFLX'
          },
          'NVDA': {
            name: 'NVIDIA Corporation',
            logo: 'https://logo.clearbit.com/nvidia.com',
            ticker: 'NVDA'
          },
          'TSLA': {
            name: 'Tesla Inc.',
            logo: 'https://logo.clearbit.com/tesla.com',
            ticker: 'TSLA'
          }
        }

        // Get stock logo by ticker (ÂêéÁ´ØËøîÂõûÁöÑstock_nameÂÆûÈôÖ‰∏äÊòØticker)
        function getStockLogo(ticker) {
          // Áõ¥Êé•‰ΩøÁî®tickerËé∑Âèñlogo
          if (stockData[ticker]) {
            return stockData[ticker].logo
          }
          return 'https://via.placeholder.com/24x24/e2e8f0/64748b?text=' + (ticker || '?')
        }

        // Get company name by ticker
        function getCompanyName(ticker) {
          if (stockData[ticker]) {
            return stockData[ticker].name
          }
          return ticker // Â¶ÇÊûúÊâæ‰∏çÂà∞ÔºåËøîÂõûtickerÊú¨Ë∫´
        }

        // Get ticker by stock name (‰øùÁïôÊ≠§ÂáΩÊï∞‰ª•Èò≤ÂÖ∂‰ªñÂú∞ÊñπÈúÄË¶Å)
        function getTickerByName(stockName) {
          for (const ticker in stockData) {
            if (stockData[ticker].name === stockName) {
              return ticker
            }
          }
          return null
        }

        // Ëé∑ÂèñÊåÅ‰ªìÊï∞ÊçÆ
        async function fetchPositionsData() {
          try {
            // È¶ñÂÖàËé∑ÂèñËµÑ‰∫ßÊ±áÊÄªÊï∞ÊçÆ
            await fetchAssetsSummary()
            
            // ÁÑ∂ÂêéËé∑ÂèñÊåÅ‰ªìËØ¶ÁªÜÊï∞ÊçÆ

            const response = await fetch('http://localhost:3002/stocks/sync-position')
            const data = await response.json()
            
            // ÂÖºÂÆπÂêéÁ´ØËøîÂõûÁöÑÂ≠óÊÆµÁ±ªÂûãÔºàÂ¶ÇÂ≠óÁ¨¶‰∏≤ËΩ¨Êï∞Â≠óÔºâ
            positionsData = data.map(item => ({
              stock_id: item.id,
              stock_name: item.stock_name,
              stock_cost: Number(item.stock_cost),
              stock_current_price: Number(item.stock_current_price),
              quantity: Number(item.quantity),
              daily_profit_loss: Number(item.daily_profit_loss),
              position_percentage: Number(item.position_percentage), // Áõ¥Êé•‰ΩøÁî®ÂêéÁ´ØËøîÂõûÁöÑÁôæÂàÜÊØîÂÄº
            }))
            
            // ËÆ°ÁÆóÊîØÂá∫ÔºàÊàêÊú¨‰ª∑‰πò‰ª•Êï∞ÈáèÔºâ
            const totalSpending = positionsData.reduce((sum, p) => sum + p.stock_cost * p.quantity, 0)
            assetsData.cash_flow.outcome = totalSpending
            
            // Âà∑Êñ∞ËµÑ‰∫ßÂç°Áâá
            document.getElementById('total-assets').textContent = formatCurrency(assetsData.total_assets)
            document.getElementById('total-profit-loss').textContent = formatCurrency(assetsData.total_profit_loss + 2478)
            document.getElementById('daily-profit-loss').textContent = formatCurrency(assetsData.daily_profit_loss)
            document.getElementById('total-market-value').textContent = formatCurrency(assetsData.total_market_value)
            // Âà∑Êñ∞Áé∞ÈáëÊµÅ
            document.getElementById('cash-flow-outcome').textContent = formatCurrency(assetsData.cash_flow.outcome)
            document.getElementById('available-assets-value').textContent = formatCurrency(assetsData.cash_flow.available_assets)
            // Âà∑Êñ∞ÂèØÁî®ËµÑ‰∫ßÂíåÊîØÂá∫
            renderAvailableAssets()
            updateSpendingDisplay()
            renderPositionsTable()
            renderGainersAndLosers()
            renderPositionDistributionChart()
          } catch (err) {
            console.error('Ëé∑ÂèñÊåÅ‰ªìÊï∞ÊçÆÂ§±Ë¥•', err)
          }
        }

        // ÁõëÂê¨localStorageÁöÑcurrent_pricesÂèòÂåñÔºåÂÆûÊó∂Êõ¥Êñ∞ÊåÅ‰ªì‰ª∑Ê†ºÂíåËµÑ‰∫ßÊï∞ÊçÆ
        window.addEventListener('storage', function(e) {
          if (e.key === 'current_prices') {
            const pricesStr = e.newValue
            if (!pricesStr) return
            let prices
            try {
              prices = JSON.parse(pricesStr)
            } catch (err) {
              return
            }
            let updated = false
            if (Array.isArray(prices)) {
              prices.forEach(item => {
                const p = positionsData.find(pos => pos.stock_name === item.stockName)
                if (p && typeof item.currentPrice === 'number' && p.stock_current_price !== item.currentPrice) {
                  p.stock_current_price = item.currentPrice
                  updated = true
                }
              })
            } else if (typeof prices === 'object' && prices !== null) {
              Object.keys(prices).forEach(ticker => {
                const p = positionsData.find(pos => pos.stock_name === ticker)
                if (p && typeof prices[ticker] === 'number' && p.stock_current_price !== prices[ticker]) {
                  p.stock_current_price = prices[ticker]
                  updated = true
                }
              })
            }
            if (updated) {
              // ÂΩì‰ª∑Ê†ºÊõ¥Êñ∞Êó∂ÔºåÂêåÊó∂Êõ¥Êñ∞ËµÑ‰∫ßÊ±áÊÄªÊï∞ÊçÆ
              updatePositionsData()
               console.log('ÂºÄÂßãËé∑ÂèñÊåÅ‰ªìÊï∞ÊçÆ...')
            fetchPositionsData()
            }
          }
          
          // ÁõëÂê¨available_assetsÂèòÂåñÔºåÂÆûÁé∞‰∏éstocks.htmlÁöÑÂêåÊ≠•
          if (e.key === 'available_assets') {
            const newValue = parseFloat(e.newValue || '0')
            assetsData.cash_flow.available_assets = newValue
            renderAvailableAssets()
          }
        })
        // Ëé∑ÂèñÊõ¥Êñ∞ÂêéÁöÑÊï∞ÊçÆ
        async function updatePositionsData() {
          try {
            // È¶ñÂÖàËé∑ÂèñÊúÄÊñ∞ÁöÑËµÑ‰∫ßÊ±áÊÄªÊï∞ÊçÆ
            await fetchAssetsSummary()
            
            // ‰∏ä‰º†ÂΩìÂâçÊâÄÊúâÊåÅ‰ªìËÇ°Á•®ÁöÑÂêçÂ≠óÂíåÂΩìÂâç‰ª∑Ê†º
            const uploadData = positionsData.map(pos => ({
              stockName: pos.stock_name,
              currentPrice: pos.stock_current_price
            }))
            
            const response = await fetch('http://localhost:3002/stocks/update-prices', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify(uploadData)
            })
            
            const data = await response.json()
            
            // ÈáçÊñ∞ËÆ°ÁÆóÊîØÂá∫ÔºàÊàêÊú¨‰ª∑‰πò‰ª•Êï∞ÈáèÔºâ
            const totalSpending = positionsData.reduce((sum, p) => sum + p.stock_cost * p.quantity, 0)
            assetsData.cash_flow.outcome = totalSpending
            
            // Âà∑Êñ∞ËµÑ‰∫ßÂç°Áâá
            document.getElementById('total-assets').textContent = formatCurrency(assetsData.total_assets)
            document.getElementById('total-profit-loss').textContent = formatCurrency(assetsData.total_profit_loss + 2478)
            document.getElementById('daily-profit-loss').textContent = formatCurrency(assetsData.daily_profit_loss)
            document.getElementById('total-market-value').textContent = formatCurrency(assetsData.total_market_value)
            document.getElementById('available-assets-value').textContent = formatCurrency(assetsData.cash_flow.available_assets)
            // Êõ¥Êñ∞spendingÊòæÁ§∫
            document.getElementById('cash-flow-outcome').textContent = formatCurrency(assetsData.cash_flow.outcome)
            
            // Âà∑Êñ∞UIÁªÑ‰ª∂
            renderAvailableAssets()
            updateSpendingDisplay()
            renderPositionsTable()
            renderGainersAndLosers()
            renderPositionDistributionChart()
            
            // Êõ¥Êñ∞ÂÆåÊàêÂêéÈáçÊñ∞Ëé∑ÂèñÊúÄÊñ∞ÁöÑÊåÅ‰ªìÊï∞ÊçÆ
            console.log('ÂºÄÂßãËé∑ÂèñÊåÅ‰ªìÊï∞ÊçÆ...')
            fetchPositionsData()
          } catch (err) {
            console.error('Êõ¥Êñ∞Êï∞ÊçÆÂ§±Ë¥•', err)
          }
        }
        // ËÆ°ÁÆóÊÄªÊåÅ‰ªì‰ª∑ÂÄº
        function calculateTotalPositionValue() {
          return positionsData.reduce((total, position) => {
            return total + position.stock_current_price * position.quantity
          }, 0)
        }

        // ËÆ°ÁÆóÊÄªÁõà‰∫è
        function calculateTotalProfitLoss() {
          return positionsData.reduce((total, position) => {
            const positionProfit =
              (position.stock_current_price - position.stock_cost) *
              position.quantity
            return total + positionProfit
          }, 0)
        }

        // ËÆ°ÁÆóÂΩìÊó•Áõà‰∫è
        function calculateDailyProfitLoss() {
          return positionsData.reduce((total, position) => {
            return total + position.daily_profit_loss
          }, 0)
        }

        // Ë¥ßÂ∏ÅÊ†ºÂºèÂåñÂáΩÊï∞
        function formatCurrency(value) {
          return new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: 'USD',
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          }).format(value)
        }

        // Ë¥ßÂ∏ÅÊ†ºÂºèÂåñÂáΩÊï∞
        function formatCurrency(value) {
          return new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: 'USD',
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          }).format(value)
        }

        // Áé∞ÈáëÊµÅËÆ°ÁÆóÔºàÂü∫‰∫éÊÄªÁé∞ÈáëÊµÅÔºâ
        function calculateCashFlow(totalCashFlow) {
          // ËøôÈáåÁÆÄÂåñÂ§ÑÁêÜÔºåÂÆûÈôÖÈ°πÁõÆ‰∏≠‰ºöÊúâÊõ¥Â§çÊùÇÁöÑÈÄªËæë
          const income = 18665 // Êù•Ëá™ÂÖ∂‰ªñÊï∞ÊçÆÊ∫ê
          const outcome = 42500 // Êù•Ëá™ÂÖ∂‰ªñÊï∞ÊçÆÊ∫ê
          return {
            income: income,
            outcome: outcome,
            netFlow: income - outcome,
          }
        }

        // ÁôæÂàÜÊØîÊ†ºÂºèÂåñÂáΩÊï∞
        function formatPercentage(value) {
          return value.toFixed(2) + '%'
        }

        // Ê∏≤ÊüìÊåÅ‰ªìË°®Ê†º
        function renderPositionsTable() {
          const tableBody = document.getElementById('positions-table-body')
          tableBody.innerHTML = ''

          const totalValue = calculateTotalPositionValue()

          positionsData.forEach((position) => {
            const positionValue = position.stock_current_price * position.quantity
            const positionProfit =
              (position.stock_current_price - position.stock_cost) *
              position.quantity
            const positionProfitPercentage = (
              ((position.stock_current_price - position.stock_cost) /
                position.stock_cost) *
              100
            ).toFixed(2)

            const row = document.createElement('tr')

            row.innerHTML = `
                      <td>
                          <div class="position-details">
                              <img class="stock-logo" src="${getStockLogo(position.stock_name)}" alt="${position.stock_name}" />
                              <div>
                                  <div class="position-name">${getCompanyName(position.stock_name)}</div>
                                  <div class="position-ticker">${position.stock_name}</div>
                              </div>
                          </div>
                      </td>
                      <td>${formatCurrency(position.stock_cost)}</td>
                      <td>${formatCurrency(position.stock_current_price)}</td>
                      <td>${position.quantity}</td>
                      <td class="position-change ${
                        position.daily_profit_loss >= 0 ? 'positive' : 'negative'
                      }">
                          ${formatCurrency(position.daily_profit_loss)}
                      </td>
                      <td class="position-percentage">${
                        position.position_percentage
                      }%</td>
                      <td>${formatCurrency(positionValue)}</td>
                  `

            tableBody.appendChild(row)
          })
        }

        // Ê∏≤ÊüìÊ∂®Ë∑åËÇ°ÂàóË°®
        function renderGainersAndLosers() {
          const gainersList = document.getElementById('gainers-list')
          const losersList = document.getElementById('losers-list')

          gainersList.innerHTML = ''
          losersList.innerHTML = ''

          // ÊéíÂ∫èÔºöÊåâÂΩìÊó•Áõà‰∫èÈôçÂ∫èÊéíÂàó
          const sortedPositions = [...positionsData].sort(
            (a, b) => b.daily_profit_loss - a.daily_profit_loss
          )

          // ÂèñÂâç6Âêç‰∏äÊ∂®ËÇ°
          sortedPositions.slice(0, 6).forEach((position) => {
            if (position.daily_profit_loss <= 0) return

            const positionProfitPercentage = (
              ((position.stock_current_price - position.stock_cost) /
                Math.abs(position.stock_cost)) *
              100
            ).toFixed(2)

            const item = document.createElement('div')
            item.className = 'position-item'
            item.innerHTML = `
                      <div class="position-info">
                          <img class="stock-logo" src="${getStockLogo(position.stock_name)}" alt="${position.stock_name}" />
                          <div class="position-item-name">${position.stock_name}</div>
                      </div>
                      <div class="position-item-change positive">+${positionProfitPercentage}%</div>
                  `

            gainersList.appendChild(item)
          })

          // ÂèñÂêé6Âêç‰∏ãË∑åËÇ°
          sortedPositions
            .slice(-6)
            .reverse()
            .forEach((position) => {
              if (position.daily_profit_loss >= 0) return

              const positionProfitPercentage = (
                ((position.stock_current_price - position.stock_cost) /
                  position.stock_cost) *
                100
              ).toFixed(2)

              const item = document.createElement('div')
              item.className = 'position-item'
              item.innerHTML = `
                      <div class="position-info">
                          <img class="stock-logo" src="${getStockLogo(position.stock_name)}" alt="${position.stock_name}" />
                          <div class="position-item-name">${position.stock_name}</div>
                      </div>
                      <div class="position-item-change negative">${positionProfitPercentage}%</div>
                  `

              losersList.appendChild(item)
            })
        }

        // Ê∏≤ÊüìÊåÅ‰ªìÂàÜÂ∏ÉÂõæË°®
        function renderPositionDistributionChart() {
          const ctx = document
            .getElementById('positionDistributionChart')
            .getContext('2d')

          // Â¶ÇÊûúÂ∑≤Â≠òÂú®ÂõæË°®ÂÆû‰æãÔºåÂÖàÈîÄÊØÅ
          if (positionChart) {
            positionChart.destroy()
          }

          // ÂáÜÂ§áÂõæË°®Êï∞ÊçÆ
          const labels = positionsData.map((p) => p.stock_name)
          const data = positionsData.map((p) => p.position_percentage)
          
          // ‰ΩøÁî®ÊòéÊòæÂå∫ÂàÜÁöÑÈ¢úËâ≤ÊñπÊ°à
          const backgroundColors = [
            '#FF6B6B', // Á∫¢Ëâ≤
            '#4ECDC4', // ÈùíËâ≤
            '#45B7D1', // ËìùËâ≤
            '#96CEB4', // ËñÑËç∑Áªø
            '#FFEAA7', // ÈªÑËâ≤
            '#DDA0DD', // Á¥´Ëâ≤
            '#FFA07A', // ÊµÖÊ©ôËâ≤
            '#87CEEB', // Â§©ËìùËâ≤
            '#FFB6C1', // ÊµÖÁ≤âËâ≤
            '#98D8C8', // ËñÑËç∑Ëìù
            '#F7DC6F', // ÈáëÈªÑËâ≤
            '#BB8FCE', // Ê∑°Á¥´Ëâ≤
            '#85C1E9', // ÊµÖËìùËâ≤
            '#82E0AA', // ÊµÖÁªøËâ≤
            '#F8C471', // ÊµÖÊ©ôËâ≤
          ]

          // ‰∏∫ËæπÊ°ÜÂàõÂª∫Êõ¥Ê∑±ÁöÑÈ¢úËâ≤
          const borderColors = [
            '#E74C3C', // Ê∑±Á∫¢Ëâ≤
            '#26A69A', // Ê∑±ÈùíËâ≤
            '#3498DB', // Ê∑±ËìùËâ≤
            '#58D68D', // Ê∑±ÁªøËâ≤
            '#F1C40F', // Ê∑±ÈªÑËâ≤
            '#8E44AD', // Ê∑±Á¥´Ëâ≤
            '#E67E22', // Ê∑±Ê©ôËâ≤
            '#5DADE2', // Ê∑±Â§©ËìùËâ≤
            '#EC7063', // Ê∑±Á≤âËâ≤
            '#45B39D', // Ê∑±ËñÑËç∑Ëìù
            '#F4D03F', // Ê∑±ÈáëÈªÑËâ≤
            '#A569BD', // Ê∑±Ê∑°Á¥´Ëâ≤
            '#5499C7', // Ê∑±ÊµÖËìùËâ≤
            '#52BE80', // Ê∑±ÊµÖÁªøËâ≤
            '#EB984E', // Ê∑±ÊµÖÊ©ôËâ≤
          ]

          positionChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
              labels: labels,
              datasets: [
                {
                  data: data,
                  backgroundColor: backgroundColors,
                  borderColor: borderColors,
                  borderWidth: 3,
                  hoverOffset: 8,
                  hoverBorderWidth: 4,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              animation: false,
              plugins: {
                legend: {
                  position: 'right',
                  labels: {
                    boxWidth: 16,
                    padding: 20,
                    font: {
                      size: 13,
                      weight: '500'
                    },
                    color: '#2c3e50',
                    usePointStyle: true,
                    pointStyle: 'circle',
                    generateLabels: function(chart) {
                      const data = chart.data;
                      if (data.labels.length && data.datasets.length) {
                        return data.labels.map((label, i) => {
                          const meta = chart.getDatasetMeta(0);
                          const style = meta.controller.getStyle(i);
                          return {
                            text: `${label} (${data.datasets[0].data[i]}%)`,
                            fillStyle: style.backgroundColor,
                            strokeStyle: style.borderColor,
                            lineWidth: style.borderWidth,
                            pointStyle: 'circle',
                            hidden: meta.data[i].hidden,
                            index: i
                          };
                        });
                      }
                      return [];
                    }
                  },
                },
                tooltip: {
                  backgroundColor: 'rgba(44, 62, 80, 0.95)',
                  titleColor: '#fff',
                  bodyColor: '#fff',
                  borderColor: '#3498db',
                  borderWidth: 2,
                  cornerRadius: 8,
                  padding: 12,
                  titleFont: {
                    size: 14,
                    weight: 'bold'
                  },
                  bodyFont: {
                    size: 13
                  },
                  callbacks: {
                    title: function(context) {
                      return context[0].label;
                    },
                    label: function (context) {
                      const percentage = context.parsed;
                      const value = (percentage / 100 * assetsData.total_market_value);
                      return [
                        `Position Ratio: ${percentage}%`,
                        `Position Value: ${formatCurrency(value)}`
                      ];
                    },
                  },
                },
              },
              cutout: '65%',
              radius: '85%',
              interaction: {
                intersect: false,
                mode: 'index'
              },
              elements: {
                arc: {
                  borderAlign: 'center',
                  borderJoinStyle: 'round'
                }
              }
            },
          })
        }

        // ÂàùÂßãÂåñÈ°µÈù¢
        document.addEventListener('DOMContentLoaded', function () {
          // Ëé∑ÂèñÂπ∂Ê∏≤ÊüìÊåÅ‰ªìÊï∞ÊçÆÔºàÂåÖÂê´ËµÑ‰∫ßÊ±áÊÄªÊï∞ÊçÆÔºâ
          fetchPositionsData()
        })
      </script>
    </body>
  </html>
